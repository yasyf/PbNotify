PbNotify
=======

PbNotify is a Remote Pebble Notification API powered by Flask and MongoDB that can easily be set up to provide a public-facing bridge between the Internet at large and local notifications on your Pebble smartwatch. It is accompanied by a watchface on the Pebble that communicates with your smartphone via [httpebble](https://github.com/Katharine/httpebble-watch). The [iOS](https://itunes.apple.com/us/app/httpebble/id650174711) or [Android](https://play.google.com/store/apps/details?id=com.lukekorth.httpebble&hl=en) httpebble app **must** be installed on your paired phone for PbNotify to work.

This service is ideal for many situations, as essentially any web app or server that could make a single API call can send notifications straight to your wrist. This was inspired by the need to be notified in a convenient manner when long-running commands on a remote server completed. Not only does PbNotify allow such notifications, but it also allows for a plethora of information to be sent along with the simple ping, such as the last command's exit status.

With the extra time I had after completing this hack, I implemented the Twilio SMS API, hooking it up to the PbNotify instance I have running on my demo site. As a result, you can directly text notifications to your watch! Simply send a text of the format `<userid>|<source>|<text>` to (617) 326-5364.

Simply start up the server, entering in your own secret key and database information, or try [the demo](http://pbnotify.herokuapp.com/). After creating an account/logging in, you will be given a userid which can then be used with the following calls. Logging into your dashboard on the server will show you all past and pending notifications.

The watchface can be easily compiled using [CloudPebble](https://cloudpebble.net), substituting in your own  `USERID`, as generated by the server.

Known Bugs
=======

1. Messages are limited to 34 characters (or so). This is most probably due to my limited (read: nonexistant) knowledge of C, hindering my ability to debug the watchface. Suggestions are more than welcome!

API
=======

###create new notification
####/notification/create/
#####{endpoint}/api/notification/create/&lt;userid&gt;/&lt;source&gt;/&lt;text&gt;
	userid: your generated userid
	source: the originating entity of your notification
	text: the text of your notification
	
	returns: json-encoded notificationid
	
	$ curl "http://pbnotify.herokuapp.com//api/notification/create/5250a011dabae068d13ee5f4/Test/HelloWorld"
	{"notificationid": "525119b8796af044768ee0db"}
	$ 

###retrieve most recent notification
####/notification/get/
#####{endpoint}/api/notification/get/&lt;userid&gt;
	userid: your generated userid
	
	returns: httpebble-friendly json-encoded notification (source and text)
	
	$ curl "http://pbnotify.herokuapp.com//api/notification/get/5250a011dabae068d13ee5f4/525119b8796af044768ee0db"
	{"1": "Test", "2": "HelloWorld"}
	$ 

###retrieve notification
####/notification/get/
#####{endpoint}/api/notification/get/&lt;userid&gt;/&lt;notificationid&gt;
	userid: your generated userid
	notificationid: the notificationid returned from a previous `/notification/create/` call

	returns: httpebble-friendly json-encoded notification (source and text)
	
	$ curl "http://pbnotify.herokuapp.com//api/notification/get/5250a011dabae068d13ee5f4"
	{"1": "Test", "2": "HelloWorld"}
	$


###mark most recent notification as delivered
####/notification/delivered/
#####{endpoint}/api/notification/delivered/&lt;userid&gt;
	userid: your generated userid

	returns: json-encoded success or failure
	
	$ curl "http://pbnotify.herokuapp.com//api/notification/delivered/5250a011dabae068d13ee5f4"
	{"status": "success"}
	$

Licence
=======
[This work is licensed under the MIT License.](http://yasyf.mit-license.org/)
