{% extends "layout.html" %}
{% block title %}Welcome{% endblock %}
{% block content %}
  <h1>PbNotify: The Remote Pebble Notification API</h1>
  <p>To begin, <a href="{{ url_for('static', filename='watchface.pbw') }}">download</a> the PbNotify watchface, install it by opening it in the Pebble app on your smartphone, and follow the set-up process to connect it with your PbNotify account. Then refer to the API documentation <a target="_blank" href="{{ url_for('api_help') }}">here</a> to begin sending notifications.</p>
  <br />
  <p>notification userid <span class="params">{{ session.userid }}</span></p>
  <p>pebble account token
  	<input type="text" class="lineput params" id="accountToken" value="{{ token }}">
  </p>
  {% if promo %}
     <p>current promo code <span class="params">{{ promo }}</span></p>
  {% endif %}
  <p><a id="clear" href="#">clear history</a></b></p>	
  <script type="text/javascript">
  $("#accountToken").blur(function(){
  	$.post("/api/account/token/{{ session.userid }}/" + $("#accountToken").val());
  });
  $("#clear").click(function(){
    $.post("/api/account/history/clear/{{ session.userid }}");
    $(".delivered").remove();
  });
  </script>	
	<div>
	 <ul id="notifications">
	  {% for notification in notifications %}
	  	{% if notification.delivered == "true" %} <del class="delivered"> {% endif %}
		<li>(<i>{{ notification.time }}</i>) <b>{{ notification.source }}</b>: {{ notification.text }}</li>
		{% if notification.delivered == "true" %} </del> {% endif %}
	  {% endfor %}
	 </ul>
	</div>
{% endblock %}